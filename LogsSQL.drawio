<mxfile host="app.diagrams.net" modified="2020-04-24T17:49:59.247Z" agent="5.0 (Windows)" etag="zxCsIxQM1rGCK4JirmpW" version="12.9.8" type="github">
  <diagram id="lD6KHarhcCYwHScnSqFV" name="Page-1">
    <mxGraphModel dx="1251" dy="1310" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="850" pageHeight="1100" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="ufBeylbA63SAaLsGzbN_-1" value="&lt;font style=&quot;font-size: 25px&quot;&gt;LOG SQL FUNCTIONS&lt;/font&gt;" style="rounded=0;whiteSpace=wrap;html=1;verticalAlign=top;" vertex="1" parent="1">
          <mxGeometry x="10" y="110" width="760" height="1760" as="geometry" />
        </mxCell>
        <mxCell id="ufBeylbA63SAaLsGzbN_-2" value="&lt;div&gt;ADD LOG TO SQL DATABASE&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;func AddLogToSQLDatabasse ( l Log ) error { }&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;-- Adds a log into the &#39;Logs&#39; SQL database&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;pre style=&quot;background-color: #2b2b2b ; color: #a9b7c6 ; font-family: &amp;#34;consolas&amp;#34; ; font-size: 9.8pt&quot;&gt;&lt;span style=&quot;color: #787878&quot;&gt;// AddLogToSQLDatabase adds a log into the SQL database&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color: #c7773e&quot;&gt;func &lt;/span&gt;&lt;span style=&quot;color: #e6b163&quot;&gt;AddLogToSQLDatabase&lt;/span&gt;(l &lt;span style=&quot;color: #6fafbd&quot;&gt;Log&lt;/span&gt;) &lt;span style=&quot;color: #c7773e&quot;&gt;error&lt;/span&gt;{&lt;br&gt;   &lt;span style=&quot;color: #c7773e&quot;&gt;var &lt;/span&gt;errorFound &lt;span style=&quot;color: #72737a&quot;&gt;string &lt;/span&gt;= &lt;span style=&quot;color: #6a8759&quot;&gt;&quot;&quot;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color: #6a8759&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color: #6a8759&quot;&gt;   &lt;/span&gt;&lt;span style=&quot;color: #787878&quot;&gt;//Connect to SQLDatabase&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color: #787878&quot;&gt;   &lt;/span&gt;stmt&lt;span style=&quot;color: #cc7832&quot;&gt;, &lt;/span&gt;err := DBCon.&lt;span style=&quot;color: #b09d79&quot;&gt;Prepare&lt;/span&gt;(&lt;span style=&quot;color: #6a8759&quot;&gt;`INSERT INTO logs (lType,lDate,lMemo,lEntity)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color: #6a8759&quot;&gt;      VALUES (&quot;` &lt;/span&gt;+ l.Type + &lt;span style=&quot;color: #6a8759&quot;&gt;`&quot;,&quot;` &lt;/span&gt;+ l.Date.&lt;span style=&quot;color: #b09d79&quot;&gt;Format&lt;/span&gt;(&lt;span style=&quot;color: #afbf7e&quot;&gt;time&lt;/span&gt;.&lt;span style=&quot;color: #9876aa ; font-style: italic&quot;&gt;RFC3339&lt;/span&gt;) + &lt;span style=&quot;color: #6a8759&quot;&gt;`&quot;,&quot;` &lt;/span&gt;+ l.Memo + &lt;span style=&quot;color: #6a8759&quot;&gt;`&quot;,&quot;`           &lt;br&gt;&lt;/span&gt;                 + l.Entity + &lt;span style=&quot;color: #6a8759&quot;&gt;`&quot;);`&lt;/span&gt;)&lt;br&gt;   &lt;span style=&quot;color: #c7773e&quot;&gt;if &lt;/span&gt;err != &lt;span style=&quot;color: #c7773e&quot;&gt;nil&lt;/span&gt;{&lt;br&gt;      errorFound = err.&lt;span style=&quot;color: #c7773e&quot;&gt;Error&lt;/span&gt;()&lt;br&gt;   }&lt;br&gt;   &lt;span style=&quot;color: #787878&quot;&gt;// Execute the statement&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color: #787878&quot;&gt;   &lt;/span&gt;r&lt;span style=&quot;color: #cc7832&quot;&gt;, &lt;/span&gt;err := stmt.&lt;span style=&quot;color: #b09d79&quot;&gt;Exec&lt;/span&gt;()&lt;br&gt;   &lt;span style=&quot;color: #c7773e&quot;&gt;if &lt;/span&gt;err != &lt;span style=&quot;color: #c7773e&quot;&gt;nil&lt;/span&gt;{&lt;br&gt;      errorFound = err.&lt;span style=&quot;color: #c7773e&quot;&gt;Error&lt;/span&gt;()&lt;br&gt;   }&lt;br&gt;   &lt;span style=&quot;color: #787878&quot;&gt;// Check that rows were affected&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color: #787878&quot;&gt;   &lt;/span&gt;n&lt;span style=&quot;color: #cc7832&quot;&gt;, &lt;/span&gt;err := r.&lt;span style=&quot;color: #b09d79&quot;&gt;RowsAffected&lt;/span&gt;()&lt;br&gt;   &lt;span style=&quot;color: #c7773e&quot;&gt;if &lt;/span&gt;err != &lt;span style=&quot;color: #c7773e&quot;&gt;nil&lt;/span&gt;{&lt;br&gt;      &lt;span style=&quot;color: #787878&quot;&gt;// Need to log any errors&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color: #787878&quot;&gt;   &lt;/span&gt;}&lt;br&gt;&lt;br&gt;   &lt;span style=&quot;color: #c7773e&quot;&gt;if &lt;/span&gt;errorFound != &lt;span style=&quot;color: #6a8759&quot;&gt;&quot;&quot;&lt;/span&gt;{&lt;br&gt;      &lt;span style=&quot;color: #c7773e&quot;&gt;return &lt;/span&gt;&lt;span style=&quot;color: #afbf7e&quot;&gt;errors&lt;/span&gt;.&lt;span style=&quot;color: #b09d79&quot;&gt;New&lt;/span&gt;(errorFound)&lt;br&gt;   }&lt;br&gt;&lt;br&gt;   &lt;span style=&quot;color: #afbf7e&quot;&gt;fmt&lt;/span&gt;.&lt;span style=&quot;color: #b09d79&quot;&gt;Println&lt;/span&gt;(&lt;span style=&quot;color: #6a8759&quot;&gt;&quot;Number of logs added - rows affected: &quot;&lt;/span&gt;&lt;span style=&quot;color: #cc7832&quot;&gt;, &lt;/span&gt;n)&lt;br&gt;   &lt;span style=&quot;color: #c7773e&quot;&gt;return nil&lt;br&gt;&lt;/span&gt;}&lt;/pre&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;br&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#006600;align=left;verticalAlign=top;spacingLeft=10;" vertex="1" parent="1">
          <mxGeometry x="30" y="170" width="720" height="580" as="geometry" />
        </mxCell>
        <mxCell id="ufBeylbA63SAaLsGzbN_-3" value="&lt;div&gt;SQL POLL LOGS BY DATE&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;func SQLPollLogsByDate (ti time.Duration, typeReq string ) ( [ ] Log, error )&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;-- Requests all of the logs of a specific type based on their duration inside of the logs database&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;pre style=&quot;background-color: #2b2b2b ; color: #a9b7c6 ; font-family: &amp;#34;consolas&amp;#34; ; font-size: 9.8pt&quot;&gt;&lt;span style=&quot;color: #787878&quot;&gt;// SQLPollLogsByDate requests logs from the SQL database based on an input&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color: #787878&quot;&gt;// specifying the amount of minutes in the past to pull from&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color: #c7773e&quot;&gt;func &lt;/span&gt;&lt;span style=&quot;color: #e6b163&quot;&gt;SQLPollLogsByDate&lt;/span&gt;(ti &lt;span style=&quot;color: #afbf7e&quot;&gt;time&lt;/span&gt;.&lt;span style=&quot;color: #6fafbd&quot;&gt;Duration&lt;/span&gt;&lt;span style=&quot;color: #cc7832&quot;&gt;, &lt;/span&gt;typeReq &lt;span style=&quot;color: #c7773e&quot;&gt;string&lt;/span&gt;) ([]&lt;span style=&quot;color: #6fafbd&quot;&gt;Log&lt;/span&gt;&lt;span style=&quot;color: #cc7832&quot;&gt;, &lt;/span&gt;&lt;span style=&quot;color: #c7773e&quot;&gt;error&lt;/span&gt;){&lt;br&gt;&lt;br&gt;   &lt;span style=&quot;color: #787878&quot;&gt;// Get all the logs from the SQL database&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color: #787878&quot;&gt;   &lt;/span&gt;rows&lt;span style=&quot;color: #cc7832&quot;&gt;, &lt;/span&gt;err := DBCon.&lt;span style=&quot;color: #b09d79&quot;&gt;Query&lt;/span&gt;(&lt;span style=&quot;color: #6a8759&quot;&gt;`SELECT lEntity,lType,lDate,lMemo FROM logs WHERE lType=&quot;` &lt;/span&gt;+           &lt;br&gt;                             typeReq + &lt;span style=&quot;color: #6a8759&quot;&gt;`&quot;;`&lt;/span&gt;)&lt;br&gt;   &lt;span style=&quot;color: #c7773e&quot;&gt;if &lt;/span&gt;err != &lt;span style=&quot;color: #c7773e&quot;&gt;nil &lt;/span&gt;{&lt;br&gt;      &lt;span style=&quot;color: #c7773e&quot;&gt;return &lt;/span&gt;[]&lt;span style=&quot;color: #6fafbd&quot;&gt;Log&lt;/span&gt;{&lt;span style=&quot;color: #6fafbd&quot;&gt;Log&lt;/span&gt;{}}&lt;span style=&quot;color: #cc7832&quot;&gt;, &lt;/span&gt;err&lt;br&gt;   }&lt;br&gt;&lt;br&gt;   &lt;span style=&quot;color: #787878&quot;&gt;// Variable to hold the output from the scan&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color: #787878&quot;&gt;   &lt;/span&gt;&lt;span style=&quot;color: #c7773e&quot;&gt;var &lt;/span&gt;iType  &lt;span style=&quot;color: #c7773e&quot;&gt;string&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color: #c7773e&quot;&gt;   var &lt;/span&gt;iDate  &lt;span style=&quot;color: #c7773e&quot;&gt;string&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color: #c7773e&quot;&gt;   var &lt;/span&gt;iMemo  &lt;span style=&quot;color: #c7773e&quot;&gt;string&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color: #c7773e&quot;&gt;   var &lt;/span&gt;iEntity &lt;span style=&quot;color: #c7773e&quot;&gt;string&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color: #c7773e&quot;&gt;   var &lt;/span&gt;SQLlogs []&lt;span style=&quot;color: #6fafbd&quot;&gt;Log&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color: #6fafbd&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color: #6fafbd&quot;&gt;   &lt;/span&gt;&lt;span style=&quot;color: #787878&quot;&gt;// Scan through results and output data&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color: #787878&quot;&gt;   &lt;/span&gt;&lt;span style=&quot;color: #c7773e&quot;&gt;for &lt;/span&gt;rows.&lt;span style=&quot;color: #b09d79&quot;&gt;Next&lt;/span&gt;(){&lt;br&gt;      rows.&lt;span style=&quot;color: #b09d79&quot;&gt;Scan&lt;/span&gt;(&amp;amp;iEntity&lt;span style=&quot;color: #cc7832&quot;&gt;, &lt;/span&gt;&amp;amp;iType&lt;span style=&quot;color: #cc7832&quot;&gt;, &lt;/span&gt;&amp;amp;iDate&lt;span style=&quot;color: #cc7832&quot;&gt;, &lt;/span&gt;&amp;amp;iMemo)&lt;br&gt;      &lt;span style=&quot;color: #787878&quot;&gt;// Convert the date to a time format&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color: #787878&quot;&gt;      &lt;/span&gt;t&lt;span style=&quot;color: #cc7832&quot;&gt;, &lt;/span&gt;_ := &lt;span style=&quot;color: #afbf7e&quot;&gt;time&lt;/span&gt;.&lt;span style=&quot;color: #b09d79&quot;&gt;Parse&lt;/span&gt;(&lt;span style=&quot;color: #afbf7e&quot;&gt;time&lt;/span&gt;.&lt;span style=&quot;color: #9876aa ; font-style: italic&quot;&gt;RFC3339&lt;/span&gt;&lt;span style=&quot;color: #cc7832&quot;&gt;, &lt;/span&gt;iDate)&lt;br&gt;      SQLlogs = &lt;span style=&quot;color: #c7773e&quot;&gt;append&lt;/span&gt;(SQLlogs&lt;span style=&quot;color: #cc7832&quot;&gt;, &lt;/span&gt;&lt;span style=&quot;color: #6fafbd&quot;&gt;Log&lt;/span&gt;{iEntity&lt;span style=&quot;color: #cc7832&quot;&gt;,&lt;/span&gt;iType&lt;span style=&quot;color: #cc7832&quot;&gt;,&lt;/span&gt;t&lt;span style=&quot;color: #cc7832&quot;&gt;, &lt;/span&gt;iMemo })&lt;br&gt;   }&lt;br&gt;&lt;br&gt;   &lt;span style=&quot;color: #787878&quot;&gt;// Range through the sql logs and pull out logs that match&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color: #787878&quot;&gt;   // the time frame&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color: #787878&quot;&gt;   &lt;/span&gt;&lt;span style=&quot;color: #c7773e&quot;&gt;var &lt;/span&gt;logs []&lt;span style=&quot;color: #6fafbd&quot;&gt;Log&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color: #6fafbd&quot;&gt;   &lt;/span&gt;&lt;span style=&quot;color: #c7773e&quot;&gt;for &lt;/span&gt;_&lt;span style=&quot;color: #cc7832&quot;&gt;, &lt;/span&gt;v := &lt;span style=&quot;color: #c7773e&quot;&gt;range &lt;/span&gt;SQLlogs{&lt;br&gt;      &lt;span style=&quot;color: #c7773e&quot;&gt;if &lt;/span&gt;&lt;span style=&quot;color: #afbf7e&quot;&gt;time&lt;/span&gt;.&lt;span style=&quot;color: #b09d79&quot;&gt;Now&lt;/span&gt;().&lt;span style=&quot;color: #b09d79&quot;&gt;Sub&lt;/span&gt;(v.Date) &amp;lt; (ti) {&lt;br&gt;         logs = &lt;span style=&quot;color: #c7773e&quot;&gt;append&lt;/span&gt;(logs&lt;span style=&quot;color: #cc7832&quot;&gt;, &lt;/span&gt;v)&lt;br&gt;      }&lt;br&gt;   }&lt;br&gt;   &lt;span style=&quot;color: #787878&quot;&gt;// Check if there were no logs&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color: #787878&quot;&gt;   &lt;/span&gt;&lt;span style=&quot;color: #c7773e&quot;&gt;if &lt;/span&gt;logs == &lt;span style=&quot;color: #c7773e&quot;&gt;nil &lt;/span&gt;{&lt;br&gt;      &lt;span style=&quot;color: #c7773e&quot;&gt;return &lt;/span&gt;[]&lt;span style=&quot;color: #6fafbd&quot;&gt;Log&lt;/span&gt;{&lt;span style=&quot;color: #6fafbd&quot;&gt;Log&lt;/span&gt;{}}&lt;span style=&quot;color: #cc7832&quot;&gt;, &lt;/span&gt;&lt;span style=&quot;color: #afbf7e&quot;&gt;errors&lt;/span&gt;.&lt;span style=&quot;color: #b09d79&quot;&gt;New&lt;/span&gt;(&lt;span style=&quot;color: #6a8759&quot;&gt;&quot;No Logs Exist in this date&quot;&lt;/span&gt;)&lt;br&gt;   }&lt;br&gt;   &lt;span style=&quot;color: #787878&quot;&gt;// Return all of the found logs that match the given time span&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color: #787878&quot;&gt;   &lt;/span&gt;&lt;span style=&quot;color: #c7773e&quot;&gt;return &lt;/span&gt;logs&lt;span style=&quot;color: #cc7832&quot;&gt;, &lt;/span&gt;&lt;span style=&quot;color: #c7773e&quot;&gt;nil&lt;br&gt;&lt;/span&gt;}&lt;/pre&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;br&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#006600;align=left;verticalAlign=top;spacingLeft=10;" vertex="1" parent="1">
          <mxGeometry x="30" y="770" width="720" height="780" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
